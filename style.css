.menu {
  max-width: 720px;
  margin: auto;
  padding: 28px 24px;
  background: linear-gradient(180deg, #111 0%, #0b0b0b 100%);
  border: 1px solid #222;
  border-radius: 12px;
  box-shadow: 0 20px 40px rgba(0,0,0,.6);
}
.battle-count {
  text-align: center;
  margin-top: 8px;
  margin-bottom: 6px;
  font-size: .9rem;
  color: #bbb;
}
.menu-title {
  font-size: 1.8rem;
  letter-spacing: 0.08em;
  text-align: center;
  margin: 0 0 6px;
  color: #d4af37;
  font-family: Garamond, 'EB Garamond', Georgia, serif;
  font-weight: bold;
}
.menu-subtitle {
  text-align: center;
  font-size: .7rem;
  color: #aaa;
  max-width: 520px;
  margin: 0 auto 18px;
  line-height: 1.6;
  font-style: italic;
}
.legion-card.masters {
  border: 3px solid #d4af37;
  background: linear-gradient(180deg, rgba(212,175,55,.15), rgba(184,134,11,.08));
}
.legion-card.club {
  border: 3px solid #5d8a33;
  background: linear-gradient(180deg, rgba(93,138,51,.15), rgba(74,112,40,.08));
}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:linear-gradient(135deg,#0a0a0a 0%,#141414 100%);color:#eee;min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:8px 12px;touch-action:manipulation}
.menu h2{font-size:2rem;margin-bottom:12px;background:linear-gradient(135deg,#81b64c,#5d8a33);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.menu p{font-size:1rem;color:#ccc;margin-bottom:16px;line-height:1.5}
.menu-btn{width:100%;padding:14px;margin:6px 0;background:linear-gradient(135deg,#81b64c,#5f8a35);color:#fff;border:none;border-radius:10px;font-size:1rem;font-weight:600;box-shadow:0 4px 0 #4a7028;cursor:pointer;transition:all .2s}
.menu-btn:hover{transform:translateY(-1px);box-shadow:0 6px 0 #4a7028}
.menu-btn:active{transform:translateY(2px);box-shadow:0 1px 0 #4a7028}
#resetBtn{background:linear-gradient(135deg,#e74c3c,#c0392b);box-shadow:0 4px 0 #8b2e24}
#resetBtn:hover{box-shadow:0 6px 0 #8b2e24}
.game-container{max-width:460px;width:100%;background:rgba(20,20,20,.7);border-radius:16px;padding:14px;margin:10px 0;display:flex;flex-direction:column;gap:12px}
.board-wrapper{width:100%;max-width:400px;aspect-ratio:1;display:grid;grid-template-columns:repeat(8,1fr);border:3px solid #222;border-radius:8px;align-self:center}
.square{aspect-ratio:1;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:background .15s}
.square.light{background:#f0d9b5}
.square.dark{background:#b58863}
.square.selected{background:#f6e58d!important;box-shadow:inset 0 0 0 4px #e67e22}
.square.last-move{background:rgba(255,215,0,.45)!important}
.square.disabled{pointer-events:none}
.piece{width:84%;height:84%;filter:drop-shadow(0 2px 4px rgba(0,0,0,.6));pointer-events:none}
.btn{padding:10px 18px;background:linear-gradient(135deg,#81b64c,#5f8a35);color:#fff;border:none;border-radius:8px;font-weight:600;font-size:.95rem;cursor:pointer;transition:all .2s}
.btn:disabled{background:#444;opacity:.6;cursor:not-allowed}
.info-line{font-size:.92rem;color:#bbb;text-align:center;margin:4px 0}
.theory-message,.end-summary{background:rgba(35,35,35,.95);padding:12px 14px;border-radius:10px;font-size:.9rem;line-height:1.5;border:1px solid rgba(129,182,76,.2);max-height:320px;overflow-y:auto}
.end-summary h3{font-size:1.1rem;margin-bottom:8px;color:#81b64c}
.stats-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;text-align:center;margin:10px 0;font-size:.9rem}
.stats-grid div strong{color:#81b64c}
.rank-progress {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
  justify-content: flex-start;
  align-items: center;
}
.rank-step{padding:4px 8px;border-radius:6px;background:rgba(50,50,50,.6);font-size:.8rem}
.rank-step.active{background:linear-gradient(135deg,#81b64c,#5d8a33);color:#111;font-weight:bold}
.battle-history{padding:6px 8px;background:rgba(40,40,40,.8);border-radius:6px;font-size:.75rem;border:1px solid rgba(129,182,76,.2);margin-top:10px;width:fit-content}
.battle-history-title{font-size:.8rem;font-weight:bold;color:#81b64c;margin-bottom:3px}
.battle-badges{display:flex;gap:3px;justify-content:flex-start;flex-wrap:wrap}
.battle-badge{padding:3px 6px;border-radius:4px;font-weight:bold;font-size:.7rem}
.battle-badge.levy{background:#e74c3c}
.battle-badge.hastatus{background:#e67e22}
.battle-badge.principes{background:#f39c12;color:#222}
.battle-badge.triarius{background:#27ae60}
.battle-badge.imperator{background:#f1c40f;color:#222}
.warning-message{background:rgba(231,76,60,.2);border:1px solid #e74c3c;padding:6px 10px;border-radius:8px;margin-top:8px;font-size:.75rem;line-height:1.3;color:#ff8888;font-weight:bold}
.demotion-message,.promotion-message{background:rgba(200,30,30,.9);padding:12px;border-radius:10px;margin-bottom:12px;font-weight:bold;text-align:center;border:1px solid #ff4444;font-size:.85rem}
.promotion-message{background:rgba(30,100,30,.9);border:1px solid #81b64c;color:#b8e986}
.game-list-item{padding:10px;background:rgba(45,45,45,.8);border-radius:8px;margin-bottom:8px;font-size:.85rem}
.game-list-item a{color:#81b64c;text-decoration:none}
.author-note{font-size:.8rem;color:#777;text-align:center;margin-top:20px;font-style:italic}
.action-buttons{display:flex;gap:10px;justify-content:center;margin-top:8px}
.legion-card {
  margin: 16px auto;
  padding: 14px;
  border-radius: 12px;
  background: rgba(20,20,20,.9);
  border: 1px solid #2a2a2a;
  width: fit-content;
  max-width: 100%;
}
.menu-cta {
  text-align: center;
  margin: 6px 0 6px;
  font-size: 1.05rem;
  color: #ccc;
}
.legion-card.masters {
  border-color: #3a3320;
  background: linear-gradient(180deg, #141209, #0c0b07);
}
.legion-card.club {
  border-color: #2a2a2a;
}
.legion-header {
  font-size: 1.05rem;
  font-weight: 700;
  margin-bottom: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}
.menu-actions {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin-bottom: 2px;
}
.menu-btn.primary {
  width: 120px;
  padding: 8px 0;
  font-size: .9rem;
  font-weight: 600;
}
.menu-btn.reset {
  width: auto;
  margin: 0 auto 6px;
  padding: 6px 12px;
  font-size: .8rem;
  background: transparent;
  border: 1px dashed #444;
  color: #888;
}
.menu-btn.reset:hover {
  color: #c66;
  border-color: #c66;
  background: rgba(120,30,30,.1);
}
.legion-status {
  font-size: .9rem;
  margin-bottom: 4px;
}
.legion-next {
  font-size: .8rem;
  color: #aaa;
  margin-bottom: 8px;
}